<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<META NAME="generator" CONTENT="http://txt2tags.org">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<LINK REL="stylesheet" TYPE="text/css" HREF="../static/fancy.css">
<TITLE>云平台试用排队系统</TITLE>
</HEAD><BODY BGCOLOR="white" TEXT="black">
<CENTER>
<H1>云平台试用排队系统</H1>
<FONT SIZE="4"><I>作者: roy@rootk.com</I></FONT><BR>
<FONT SIZE="4">2013/03/09</FONT>
</CENTER>

<P></P>
<HR NOSHADE SIZE=1>
<P></P>

  <UL>
  <LI><A HREF="#toc1">1. 项目介绍</A>
  <LI><A HREF="#toc2">2. 结构图</A>
  <LI><A HREF="#toc3">3. 结构说明</A>
    <UL>
    <LI><A HREF="#toc4">3.1. 定时器</A>
    <LI><A HREF="#toc5">3.2. Nginx API</A>
    <LI><A HREF="#toc6">3.3. MongoDB</A>
    <LI><A HREF="#toc7">3.4. RESTful API</A>
    </UL>
  <LI><A HREF="#toc8">4. 功能截图</A>
    <UL>
    <LI><A HREF="#toc9">4.1. 总览和记录</A>
    <LI><A HREF="#toc10">4.2. 申请主机</A>
    <LI><A HREF="#toc11">4.3. 主机列表</A>
    <LI><A HREF="#toc12">4.4. 主机详情</A>
    </UL>
  <LI><A HREF="#toc13">5. 目前应用</A>
  </UL>

<P></P>
<HR NOSHADE SIZE=1>
<P></P>

<A NAME="toc1"></A>
<H1>1. 项目介绍</H1>

<OL>
<LI>根据有限的资源数量，使用可变的策略来决定请求应该立刻被处理还是排队
<LI>RESTful接口，可以处理任意类型的请求，不仅限于Openstack
<LI>定时器运行于线程中，可精确处理请求
<LI>MongoDB作为数据持久化，可在队列服务崩溃后从DB中恢复定时器
<LI>使用NGINX作为对虚拟机实例的TCP端口映射
</OL>

<A NAME="toc2"></A>
<H1>2. 结构图</H1>

<P>
<IMG ALIGN="middle" SRC="/static/images/workqueue/cloudqueue.jpeg" BORDER="0" ALT="">
</P>

<A NAME="toc3"></A>
<H1>3. 结构说明</H1>

<A NAME="toc4"></A>
<H2>3.1. 定时器</H2>

<P>
收到请求后，如果请求被处理，则启动定时器。
定时器到期后，执行指定的动作。
删除动作完成后，通知另一个在等待的线程，从排队区域取出数据，并执行动作。
</P>

<A NAME="toc5"></A>
<H2>3.2. Nginx API</H2>

<P>
封装NGINX增加TCP负载均衡的接口，并在client和server之间采用UDP多播通讯。
传输数据使用AES 256加密。
</P>

<A NAME="toc6"></A>
<H2>3.3. MongoDB</H2>

<P>
MongoDB作为保存运行和排队的数据，如果服务器崩溃，或者重启，会从DB中恢复定时器。
</P>

<A NAME="toc7"></A>
<H2>3.4. RESTful API</H2>

<P>
使用Tornado作为RESTful Server，使用GET/POST/PUT/DELETE方法对应相应的动作。
和CloudOpen之间采用HTTP调用，并使用异步的HTTP客户端。
防止因为CloudOpen长时间无响应，而阻塞Tornado的主线程。
</P>

<A NAME="toc8"></A>
<H1>4. 功能截图</H1>

<A NAME="toc9"></A>
<H2>4.1. 总览和记录</H2>

<P>
<IMG ALIGN="middle" SRC="/static/images/workqueue/summary.jpg" BORDER="0" ALT="">
</P>

<A NAME="toc10"></A>
<H2>4.2. 申请主机</H2>

<P>
<IMG ALIGN="middle" SRC="/static/images/workqueue/request.jpg" BORDER="0" ALT="">
</P>

<A NAME="toc11"></A>
<H2>4.3. 主机列表</H2>

<P>
<IMG ALIGN="middle" SRC="/static/images/workqueue/list.jpg" BORDER="0" ALT="">
</P>

<A NAME="toc12"></A>
<H2>4.4. 主机详情</H2>

<P>
<IMG ALIGN="middle" SRC="/static/images/workqueue/detail.jpg" BORDER="0" ALT="">
</P>

<A NAME="toc13"></A>
<H1>5. 目前应用</H1>

<P>
在嘉值云计算的试用平台上运行<A HREF="http://try.cloud-open.cn">http://try.cloud-open.cn</A>
</P>

<!-- html code generated by txt2tags 2.6 (http://txt2tags.org) -->
<!-- cmdline: txt2tags index.t2t -->
</BODY></HTML>
